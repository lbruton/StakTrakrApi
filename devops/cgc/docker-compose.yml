services:
  cgc-server:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: cgc-server
    stdin_open: true
    tty: true
    restart: unless-stopped
    volumes:
      # Mount entire GitHub directory â€” indexes any project without container changes
      - /Volumes/DATA/GitHub:/workspace:ro
      # Persist CGC config and Neo4j graph data across restarts
      - cgc-data:/root/.codegraphcontext
    environment:
      - PYTHONUNBUFFERED=1
    networks:
      - default
      - infra

volumes:
  cgc-data:
    driver: local

networks:
  infra:
    external: true
